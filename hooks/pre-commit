#!/bin/bash

# Pre-commit hook for Elmir project
# Runs cargo fmt and fails commit so files need to be re-added

set -e

echo "ğŸ” Running pre-commit checks..."

# Check if we're in a Rust project
if [ ! -f "Cargo.toml" ]; then
    echo "âŒ No Cargo.toml found, skipping Rust checks"
    exit 0
fi

# Run cargo fmt to format all files
echo "ğŸ“ Running cargo fmt..."
cargo fmt --all

# Check if any files were changed by formatting
if ! git diff --quiet; then
    echo "âŒ Files were formatted by cargo fmt."
    echo "ğŸ’¡ Please re-add the formatted files and commit again:"
    echo "   git add -A && git commit"
    exit 1
fi

echo "âœ… All checks passed!"